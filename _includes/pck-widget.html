<!-- _includes/pck-widget.html -->
<!-- PCK Widget - Benchmark visuale Ob Session -->
<!-- Parametri: figa, cdc, sc, jj_pta, jj_atp, ct, ai -->
<!-- ðŸ† PCK WIDGET v2.0 - Root + Anker Production -->
<!-- "Widget che non si rompe mai" - cit. Puck mentre debugga alle 3 di notte -->

<div class="pck-widget">
  
  <!-- Gauge semicerchio fIGA -->
  <div class="pck-gauge">
    <!-- SVG gauge qui (se giÃ  ce l'hai lascia cosÃ¬) -->
    <svg viewBox="0 0 200 120" class="gauge-svg">
      <path class="gauge-bg" d="M 20 100 A 80 80 0 0 1 180 100" 
            fill="none" stroke="#D4D0C8" stroke-width="8"/>
      
      <!-- ðŸŽ¨ Fill colorato basato su valore fIGA -->
      {% if page.figa >= 71 %}
        {% assign gauge_color = "#0057A3" %}
      {% elsif page.figa >= 41 %}
        {% assign gauge_color = "#C89F65" %}
      {% else %}
        {% assign gauge_color = "#B54A2F" %}
      {% endif %}
      
      <!-- Calcola angolo: 0-100 â†’ 0-180 gradi -->
      {% assign angle = page.figa | times: 1.8 %}
      {% assign rad = angle | times: 0.0174533 %}
      {% assign x = 100 | plus: rad | cos | times: 80 %}
      {% assign y = 100 | minus: rad | sin | times: 80 %}
      
      <path class="gauge-fill" 
            d="M 20 100 A 80 80 0 {% if page.figa > 50 %}1{% else %}0{% endif %} 1 {{ x }} {{ y }}" 
            fill="none" 
            stroke="{{ gauge_color }}" 
            stroke-width="8"/>
    </svg>
    
    <div class="gauge-value">{{ page.figa }}</div>
    <div class="gauge-label">fIGA</div>
  </div>

  <!-- ðŸ“Š Barre primitive PCK -->
  <div class="pck-scores">
    
    <!-- CDC - Caos Di Cane -->
    {% if page.pck.cdc %}
    <div class="pck-bar">
      <span class="pck-bar-label">CDC</span>
      <div class="pck-bar-track">
        <div class="pck-bar-fill pck-cdc" 
             style="width: {{ page.pck.cdc | times: 10 }}%"></div>
      </div>
      <span class="pck-bar-value">{{ page.pck.cdc }}</span>
    </div>
    {% endif %}
    
    <!-- SC - Studio Cognitivo -->
    {% if page.pck.sc %}
    <div class="pck-bar">
      <span class="pck-bar-label">SC</span>
      <div class="pck-bar-track">
        <div class="pck-bar-fill pck-sc" 
             style="width: {{ page.pck.sc | times: 10 }}%"></div>
      </div>
      <span class="pck-bar-value">{{ page.pck.sc }}</span>
    </div>
    {% endif %}
    
    <!-- JJ_PTA - Joke Jazz Pattern to Art -->
    {% if page.pck.jj_pta %}
    <div class="pck-bar">
      <span class="pck-bar-label">JJ_PTA</span>
      <div class="pck-bar-track">
        <div class="pck-bar-fill pck-jj-pta" 
             style="width: {{ page.pck.jj_pta | times: 10 }}%"></div>
      </div>
      <span class="pck-bar-value">{{ page.pck.jj_pta }}</span>
    </div>
    {% endif %}
    
    <!-- JJ_ATP - Art to Pattern -->
    {% if page.pck.jj_atp %}
    <div class="pck-bar">
      <span class="pck-bar-label">JJ_ATP</span>
      <div class="pck-bar-track">
        <div class="pck-bar-fill pck-jj-atp" 
             style="width: {{ page.pck.jj_atp | times: 10 }}%"></div>
      </div>
      <span class="pck-bar-value">{{ page.pck.jj_atp }}</span>
    </div>
    {% endif %}
    
  </div>
  
  <!-- CT - Context Type -->
  {% if page.ct %}
  <div class="pck-ct">
    <strong>CT:</strong> {{ page.ct }}
  </div>
  {% endif %}
  
  <!-- ðŸ”— Link filtri -->
  <div class="pck-filters">
    <a href="/ai/{{ page.ai_slug }}/">Filtra per AI</a>
    {% if page.ct %}
    <a href="/ct/{{ page.ct | slugify }}/">Filtra per CT</a>
    {% endif %}
  </div>
  
</div>

<!-- ðŸŒ³ Root says: "Se questo widget si rompe, Ã¨ colpa del futuro Puck che ha cambiato tutto alle 2 di notte" -->
